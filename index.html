<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Headless Project with WordPress, React and GraphQL</title>

		<link rel="stylesheet" href="css/reset.css">
		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/solarized.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/monokai.css">

		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
		<link rel="stylesheet" href="css/customCss.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section data-markdown>
					<textarea data-template>
						## Headless wordpress

						with GraphQL & ReactJS
					</textarea>
				</section>
				<section>
					<h3>To follow along</h3>
					<p>https://ebeldev.github.io/wordcamp-montreal-2018-slides-headless-project-reedited/</p>
				</section>

				<section>
					<img src="./assets/learn-javascript.png#h90" alt="">
				</section>

				<section>
					<h2>the goal for today</h2>
					<p>- Use Wordpress as a backend service api</p>
					<p>& use new stack to deliver the front-end</p>
					<p class="fragment fade-in">Front-end stack for today = ReactJS and GraphQL</p>
				</section>

				<section>
					<h2>Étienne Bélanger</h2>
					<div class="fbx fbx30 bio pfz08">
						<div>
							<img src="../assets/portrait2018.jpg" />
						</div>
						<div class="list-wrapper">
							<ul>
								<li>Self-taugh web developper</li>
								<li>WordPress lover for more then 10 years</li>
								<li>Work @ DistrictWeb as full-stack developer</li>
								<li>Contact
									<ul>
										<li><i class="fas fa-envelope-square"></i>etienne@etiennebelanger.com</li>
										<li><i class="fab fa-linkedin"></i>belangeretienne</li>
										<li><i class="fab fa-twitter"></i>@ebeldev</li>
										<li><i class="fab fa-github"></i>@ebeldev</li>
									</ul>
								</li>
							</ul>
						</div>
					</div>
				</section>

				<section>
					<div class="fbx fbx50">
						<div>
							<img src="../assets/Mosaic-Web-Browser.png" />
						</div>
						<div class="list-wrapper">
							<h2>The web has changed a lot</h2>
						</div>
					</div>
				</section>

				<section>
					<div class="fbx fbx50">
						<div>
							<img src="../assets/old-wordpress.png" />
						</div>
						<div class="list-wrapper">
							<h2>and so did WordPress</h2>
						</div>
					</div>
				</section>

				<section data-markdown>
					<textarea data-template>
						![Tradional CMS](../assets/traditional-cms.png)
					</textarea>
				</section>
				<section data-markdown>
					<textarea data-template>
						![Internet of things](../assets/internet-of-things-1.png)
					</textarea>
				</section>
				<section data-markdown>
					<textarea data-template>
						![Internet of things](../assets/internet-of-things-2.png)
					</textarea>
				</section>
				<section data-markdown>
					<textarea data-template>
						![Internet of things](../assets/internet-of-things-3.png)
					</textarea>
				</section>
				<section data-markdown>
					<textarea data-template>
						![Headless Decoupled](../assets/headless-decoupled.png#h80)
					</textarea>
				</section>
				<section data-markdown>
					<textarea data-template>
						![Headless WordPress](../assets/headless-wordpress.png#h80)
					</textarea>
				</section>

				<section>
					<h2>Advantages of Headless CMS</h2>
					<p class="fragment fade-in-then-semi-out">separate content and presentation</p>
					<p class="fragment fade-in-then-semi-out">generate unique user experiences</p>
					<p class="fragment fade-in-then-semi-out">make your content available to mobile apps, kiosk, VR experiences, and other mediums</p>
				</section>

				<section>
					<div class="fbx fbx50">
						<div>
							<h2>Rest Api</h2>
							<p>/wp-json/wp/v2/</p>
						</div>
						<div>
							<img src="../assets/rest-api.png#h80" />
						</div>
					</div>
				</section>
				<section>
					<div class="fbx fbx50">
						<div>
							<img src="../assets/card-ui.png" />
						</div>
						<div>
							<h2>Rest Api</h2>
							<span>/wp-json/wp/v2/</span>
							<p class="fragment fade-in">/posts</p>
							<p class="fragment fade-in">/media/"id"</p>
							<p class="fragment fade-in">/users/"id"</p>
							<p class="fragment fade-in">/categories/"id"</p>
						</div>
					</div>
				</section>

				<section>
					<h2>Rest Api</h2>
					<p>desavantages</p>
					<p class="fragment fade-in-then-semi-out">Over-fetching = <em>a client downloads more information than is actually needed</em></p>
					<p class="fragment fade-in-then-semi-out">Under-fetching =  <em>a specific endpoint doesn’t provide enough of the required information</em></p>
					<p class="fragment fade-in-then-semi-out">Maintainability and Scalability <em>having too many endpoints</em></p>
				</section>

				<section>
					<div class="fbx fbx50">
						<div>
							<img src="../assets/graphql-logo.png" />
						</div>
						<div>
							<p class="fragment fade-in">Open-sourced by Facebook in 2015</p>
							<p class="fragment fade-in">A query language for your API</p>
						</div>
					</div>
				</section>

				<section data-markdown>
					<textarea data-template>
						![Rest vs GraphQL](../assets/rest-vs-graphql.png#h90)
					</textarea>
				</section>

				<section>
					<h2>GraphQL</h2>
					<p>Type of operations you can do on your api</p>
					<p class="fragment fade-in-then-semi-out">Query <em>get your data</em></p>
					<p class="fragment fade-in-then-semi-out">Mutation <em>modify your data</em></p>
					<p class="fragment fade-in-then-semi-out">Subscription <em>subscribe to action</em></p>
				</section>

				<section>
					<h3>GraphQL <em>has two parts</em></h3>
					<div class="fbx fbx50 fbxstart">
						<div>
							<h5>Server</h5>
							<p class="fragment fade-in fz06">Responsible for the SCHEMA of your API and resolvers of the data</p>
								<pre class="fragment fade-in sW"><code data-trim>
type Query {
 posts: [Post]
}

type Post {
 title: String
 content: String
 author: Author
}

type Author {
 name: String
 avatar: String 
 posts: [Post]
}
</code></pre>
						
						</div>
						<div>
							<h5>Client</h5>
							<p class="fragment fade-in fz06">Responsible for making the query to the server</p>
							<p class="fragment fade-in">
								<!-- <img src="../assets/graphql-client.png#h50" /> -->
								<pre class="fragment fade-in sW"><code data-trim>
								query {
								 posts {
								  title
								  author {
								   name
								   avatar
								  }
								 }
								}
								</code></pre>
							</p>
							<p class="fragment fade-in">
								<!-- <img src="../assets/graphql-client.png#h50" /> -->
								<pre class="fragment fade-in sW"><code data-trim>
{"data": {
  "posts": {
   "edges": [{
     "node": {
      "title": "Hello World",
      "author": {
	   name: "My super name",
       avatar: "http://www.imagesource.com/authoravatar.jpg"
	  }
     }
   }]
  }
}}
								</code></pre>
							</p>
						</div>
					</div>
				</section>

				<section>
					<h2>GraphQL <em>options</em></h2>
					<div class="fbx fbx50 fbxstart">
						<div>
							<h3>Server</h3>
							<p class="fragment fade-in fx08">Custom</p>
							<p class="fragment fade-in fx08">Prisma<span>Framework for self-hosted GraphQL server</span></p>
							<p class="fragment fade-in fx08">WordExpress<span>Framework to help develop Wordpress applications (server + client)</span></p>
							<p class="fragment fade-in fx08">wp-graphql<span>WordPress plugin</span><span>https://github.com/wp-graphql/wp-graphql</span></p>
						</div>
						<div>
							<h3>Client</h3>
							<p class="fragment fade-in fx08">Relay<span>From Facebook, for more advance developpers</span></p>
							<p class="fragment fade-in fx08">Apollo-client<span>Apollo-boost = no setup, cache, manage local and server data</span></p>
						</div>
					</div>
				</section>

				<section data-markdown>
					<textarea data-template>
						![GraphQL Nodes](../assets/graphqlnode.png#h80)
					</textarea>
				</section>

				<section>
					<h2>WordPress Setup</h2>
					<p>WordPress will serve as the backend system on which GraphQL will be hocked on</p>
					<p>Install wp-graphql plugin</p>
				</section>

				<section class="fbxl">
					<h3 class="noM">Extending Wp-Graphql plugin <em>in your theme functions.php</em></h3>				
					<pre><code class="php" data-trim>
use WPGraphQL\Types;

function wcgql_add_custom_fields_to_graphql ($fields) {
  $fields['custom'] = [
    'type' 			=> Types::String(),
	'description'	=> __( 'The date the film was released', 'wcmtl-graphql' ),
	'resolve'		=> function ( \WP_Post $post ) {
	  // Get your data
	  $customField = get_post_meta( $post->ID, 'custom_field_name', true );
	  // make any modification on your data
	
	  // Return your data
	  return $customField;
	},
  ];

  return $fields;
}

add_filter( 'graphql_post_fields', 'wcgql_add_custom_fields_to_graphql', 10, 1 );
</code></pre>
						
						</section>

				<section class="pfz08">
					<h2>ReactJS Setup</h2>
					<p class="fragment fade-in-then-semi-out">NodeJS</p>
					<p class="fragment fade-in-then-semi-out">In your command line</p>
					<p class="fragment fade-in-then-semi-out">npx create-react-app nameofyourproject</p>
					<p class="fragment fade-in-then-semi-out">cd nameofyourproject</p>
					<ul>
						<li class="fragment fade-in-then-semi-out">npm install apollo-boost react-apollo graphql —-save
							<ul>
								<li class="fragment fade-in-then-semi-out">apollo-boost: Apollo-Client</li>
								<li class="fragment fade-in-then-semi-out">react-apollo: View layer integration in react</li>
								<li class="fragment fade-in-then-semi-out">graphql: Parses GraphQL queries</li>
							</ul>
						</li>
					</ul>
					<p class="fragment fade-in-then-semi-out">npm install react-router-dom —-save</p>
					<p class="fragment fade-in-then-semi-out">npm start</p>
					<p class="fragment fade-in-then-semi-out">localhost:3000</p>

				</section>
<section>
	<section>

		<h3 class="noM">Apollo-Boost Client Setup <em>Create a Provider</em></h3>

		<pre><code class="hljs ts" data-trim data-line-numbers="3">
	import React, { Component } from 'react';
	import ApolloClient from "apollo-boost";
	import { ApolloProvider } from "react-apollo";

	const client = new ApolloClient({
	uri: "http://localhost/wordcamp2018/graphql"
	});

	class App extends Component {
	render() {
	return (
	<ApolloProvider client={client}>
		<div>
		<h1>Welcome to Headless WordPress</h1>
		</div>
	</ApolloProvider>
	);
	}
	}

	export default App;
								</code></pre>
	</section>
	
	<section>

		<h3 class="noM">Apollo-Boost Client Setup <em>Create a client</em></h3>

		<pre><code class="hljs ts" data-trim data-line-numbers="5-7">
	import React, { Component } from 'react';
	import ApolloClient from "apollo-boost";
	import { ApolloProvider } from "react-apollo";

	const client = new ApolloClient({
	uri: "http://localhost/wordcamp2018/graphql"
	});

	class App extends Component {
	render() {
	return (
	<ApolloProvider client={client}>
		<div>
		<h1>Welcome to Headless WordPress</h1>
		</div>
	</ApolloProvider>
	);
	}
	}

	export default App;
								</code></pre>
	</section>

	<section>
	
		<h3 class="noM">Apollo-Boost Client Setup <em>Wrap your provider</em></h3>
	
		<pre><code class="hljs ts" data-trim data-line-numbers="12,16">
		import React, { Component } from 'react';
		import ApolloClient from "apollo-boost";
		import { ApolloProvider } from "react-apollo";
	
		const client = new ApolloClient({
		uri: "http://localhost/wordcamp2018/graphql"
		});
	
		class App extends Component {
		render() {
		return (
		<ApolloProvider client={client}>
			<div>
			<h1>Welcome to Headless WordPress</h1>
			</div>
		</ApolloProvider>
		);
		}
		}
	
		export default App;
									</code></pre>
	</section>
	<section>
	
		<h3 class="noM">Apollo-Boost Client in Component <em>Import Libraries</em></h3>
	
		<pre><code class="hljs ts" data-trim data-line-numbers="2,3">
		import React, { Fragment } from 'react';
		import { Query } from 'react-apollo';
		import gql from 'graphql-tag';
		</code></pre>
	</section>
	<section>
	
		<h3 class="noM">Apollo-Boost Client in Component <em>Create your query</em></h3>
	
		<pre><code class="hljs ts" data-trim data-line-numbers="5-16">
		import React, { Fragment } from 'react';
		import { Query } from 'react-apollo';
		import gql from 'graphql-tag';
		
		const GET_POSTS = gql`
		 query GET_POSTS {
		  posts {
		   edges {
		    node {
		     id
		     title
		     date
		    }
		   }
		  }
		 }
		`;
									</code></pre>
	</section>
	<section>
	
		<h3 class="noM">Apollo-Boost Client in Component <em>Output the data</em></h3>
	
		<pre><code class="hljs ts" data-trim>
		export default function Posts() {
		 return (
		  <Query query={GET_POSTS}>
		   {({ data, loading, error }) => {
		    if (loading) return <p>A spinner</p>;
		    if (error) return <p>ERROR</p>;
		
			return (
			 <Fragment>
			  {data.posts &&
			   data.posts.posts &&
			   data.posts.posts.map(post => (
			    console.log(post)
			  ))}
			 </Fragment>
		    );
		   }}
		  </Query>
		 );
		};
</code></pre>
	</section>
</section>

				<section data-background-image="../assets/victory.jpg">
				</section>

				<section>
					<h2>Demo</h2>
					<p class="fragment fade-in-then-semi-out">Download the slides</p>
					<p class="fragment fade-in">https://github.com/Ebeldev/wordcamp-graphql-slides</p>
					<p class="fragment fade-in-then-semi-out">Download the demo</p>
					<p class="fragment fade-in">https://github.com/Ebeldev/wordcampmtl2018react</p>
				</section>

				<section>
					<h2>Extra</h2>
					<p class="fragment fade-in">GraphQL + Wordpress with Jason Bahl <a href="https://www.youtube.com/watch?v=tYXlHb2eyQw">https://www.youtube.com/watch?v=tYXlHb2eyQw</a></p>
					<p class="fragment fade-in">GraphQL + Wordpress Learning site <a href="https://edwincromley.gitbooks.io/wp-graphql/content/">https://edwincromley.gitbooks.io/wp-graphql/content/</a></p>
					<p class="fragment fade-in">Learn GraphQL <a href="https://www.howtographql.com">howtographql.com</a></p>
					<p class="fragment fade-in">Apollo GraphQL <a href="apollographql.com">apollographql.com</a></p>
				</section>

			</div>
		</div>

		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				// width: "90%",
				// height: "100%",
				// margin: 0,
				// minScale: 0.2,
				// maxScale: 1.2,
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true }
				]
			});
		</script>
	</body>
</html>
